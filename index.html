<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Sakura Tap ‚Äì Demo</title>

<style>
:root{
  --gold:#d4a956;
  --text:#f7f3ea;
}

*{box-sizing:border-box}
html,body{margin:0;height:100%}
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:#000;
  color:var(--text);
  overflow:hidden;
}

.bg{
  position:fixed;inset:0;
  background:
    linear-gradient(rgba(0,0,0,.3),rgba(0,0,0,.6)),
    url("./assets/images/sakura-bg.png") center/cover no-repeat;
}

.shell{
  position:relative;
  width:min(860px,calc(100vw - 20px));
  margin:10px auto;
  border-radius:22px;
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.15);
  overflow:hidden;
}

header{padding:16px}
h1{margin:0;font-size:20px}
.rules{font-size:13px;opacity:.85;margin-top:8px}

.stageWrap{padding:0 16px 16px}
#stage{
  position:relative;
  height:70vh;
  border-radius:18px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,.15);
}

.hud{
  position:absolute;
  top:10px;left:10px;right:10px;
  display:flex;
  justify-content:space-between;
  pointer-events:none;
  z-index:5;
}
.pill{
  padding:8px 12px;
  border-radius:999px;
  background:rgba(0,0,0,.5);
  border:1px solid rgba(255,255,255,.2);
  font-weight:800;
  font-size:13px;
}

/* üî• FIX DOS BOT√ïES üî• */
.center{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  background:rgba(0,0,0,.4);
  z-index:10;
  pointer-events:none; /* ‚Üê chave */
}
.center .panel{
  pointer-events:auto; /* ‚Üê cliques voltam */
}

.panel{
  background:rgba(0,0,0,.6);
  border:1px solid rgba(255,255,255,.2);
  border-radius:18px;
  padding:20px;
  width:min(340px,90%);
  text-align:center;
}

button{
  width:100%;
  margin-top:10px;
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.3);
  background:rgba(0,0,0,.6);
  color:white;
  font-weight:900;
  cursor:pointer;
}
button:hover{background:rgba(212,169,86,.25)}

.petal{
  position:absolute;
  transform:translate(-50%,-50%);
  width:38px;
  height:44px;
}
.petal svg{width:100%;height:100%}

.toast{
  position:absolute;
  bottom:10px;
  left:0;right:0;
  text-align:center;
  font-size:13px;
}
</style>
</head>

<body>
<div class="bg"></div>

<div class="shell">
<header>
  <h1>üå∏ Sakura Tap</h1>
  <div class="rules">
    18‚Äì24 = Free miso ‚Ä¢ 25‚Äì29 = 50% off ‚Ä¢ 30+ = Free katsu curry
  </div>
</header>

<div class="stageWrap">
<div id="stage">

  <div class="hud">
    <div class="pill">‚è± <span id="time">15.0</span>s</div>
    <div class="pill">üå∏ <span id="score">0</span></div>
  </div>

  <div class="center" id="overlay">
    <div class="panel">
      <h3>Ready?</h3>
      <p>Tap ONLY gold petals</p>
      <button id="startBtn">START</button>
      <button id="soundBtn">Sound: ON</button>
    </div>
  </div>

  <div class="toast" id="toast"></div>
</div>
</div>
</div>

<script>
const DEV_MODE = new URLSearchParams(location.search).get("dev")==="1";

const stage=document.getElementById("stage");
const overlay=document.getElementById("overlay");
const startBtn=document.getElementById("startBtn");
const soundBtn=document.getElementById("soundBtn");
const scoreEl=document.getElementById("score");
const timeEl=document.getElementById("time");
const toast=document.getElementById("toast");

let running=false,score=0,time=15,petals=[],soundOn=true;
let last=0;

function petalSVG(gold){
  return `
<svg viewBox="0 0 100 120">
<defs>
<radialGradient id="g">
<stop offset="0%" stop-color="#fff"/>
<stop offset="60%" stop-color="${gold?'#e9c779':'#ffb4d1'}"/>
<stop offset="100%" stop-color="${gold?'#d4a956':'#ff8ab8'}"/>
</radialGradient>
</defs>
<path d="M50 6 C72 18 92 42 88 67 C84 92 62 112 50 114 C38 112 16 92 12 67 C8 42 28 18 50 6Z" fill="url(#g)"/>
</svg>`;
}

function spawn(){
  const p=document.createElement("div");
  const gold=Math.random()<0.3;
  p.className="petal";
  p.innerHTML=petalSVG(gold);
  p.x=Math.random()*stage.clientWidth;
  p.y=-40;
  p.vy=80+Math.random()*120;
  p.vx=-40+Math.random()*80;
  p.gold=gold;
  p.onclick=e=>{
    if(!running)return;
    if(!gold)return;
    score++;scoreEl.textContent=score;
    toast.textContent="+1 üå∏";
    setTimeout(()=>toast.textContent="",300);
    p.remove();
    petals=petals.filter(x=>x!==p);
  };
  stage.appendChild(p);
  petals.push(p);
}

function loop(ts){
  if(!running)return;
  const dt=(ts-last)/1000; last=ts;
  time-=dt;
  timeEl.textContent=Math.max(0,time).toFixed(1);
  if(Math.random()<dt*5)spawn();

  petals.forEach(p=>{
    p.y+=p.vy*dt;
    p.x+=p.vx*dt+Math.sin(ts/300)*30*dt;
    p.style.left=p.x+"px";
    p.style.top=p.y+"px";
    if(p.y>stage.clientHeight+50){
      p.remove();
      petals=petals.filter(x=>x!==p);
    }
  });

  if(time<=0){running=false;overlay.style.display="grid";}
  else requestAnimationFrame(loop);
}

startBtn.onclick=()=>{
  overlay.style.display="none";
  score=0;time=15;scoreEl.textContent=0;
  petals.forEach(p=>p.remove());petals=[];
  running=true;last=performance.now();
  requestAnimationFrame(loop);
};

soundBtn.onclick=()=>{
  soundOn=!soundOn;
  soundBtn.textContent="Sound: "+(soundOn?"ON":"OFF");
};
</script>
</body>
</html>
